@model IEnumerable<Quiz>    
@* The view receives a collection of Quiz objects *@

@{
    ViewData["Title"] = "Quizzes";   @* Sets the page title for layout and browser tab *@
}

@* Header with title and "New Quiz" button aligned side-by-side *@
<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Quizzes</h2>
    
    @* Button to navigate to the Create Quiz page *@
    @if (User.IsInRole("Admin"))
    {
        <a class="btn btn-primary" asp-action="Create">New Quiz</a>
    }
</div>

@* Table to display the list of quizzes *@
<table class="table table-striped">
    <thead>
        <tr>
            <th>Title</th>          @* Column for quiz title *@
            <th>Description</th>    @* Column for quiz description *@
            <th style="width:240px;"></th>  @* Column for action buttons (Edit/Delete/etc.) *@
        </tr>
    </thead>
    <tbody>
    @foreach (var q in Model)   @* Loop through each quiz in the list *@
    {
        <tr>
            <td>@q.Title</td>           @* Display quiz title *@
            <td>@q.Description</td>     @* Display quiz description *@
            <td class="text-end action-buttons">  @* RIGHT ALIGN + allow CSS spacing *@
                
                @* Admin-only buttons: details, edit, delete *@
                @if (User.IsInRole("Admin"))
                {
                    @* Button to view quiz details *@
                    <a class="btn btn-sm btn-secondary" 
                       asp-action="Details" 
                       asp-route-id="@q.QuizId">
                        Details
                    </a>

                    @* Button to edit the quiz *@
                    <a class="btn btn-sm btn-warning" 
                       asp-action="Edit" 
                       asp-route-id="@q.QuizId">
                        Edit
                    </a>

                    @* Button to delete the quiz *@
                    <a class="btn btn-sm btn-danger" 
                       asp-action="Delete" 
                       asp-route-id="@q.QuizId">
                        Delete
                    </a>
                }

                @* Button to take the quiz as a participant (visible to everyone) *@
                <a class="btn btn-sm btn-primary" 
                   asp-action="Take" 
                   asp-route-id="@q.QuizId">
                    Take Quiz
                </a>
            </td>
        </tr>
    }
    </tbody>
</table>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        // Simple client-side error handler for this page
        window.addEventListener("error", function (event) {
            console.error("Client error on Quiz page:", event.error || event.message);
            alert("Something went wrong on this page. Please try again.");
        });
    </script>
}
